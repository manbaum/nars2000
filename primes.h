//***************************************************************************
//  NARS2000 -- Prime Factoring Header
//***************************************************************************

/***************************************************************************
    NARS2000 -- An Experimental APL Interpreter
    Copyright (C) 2006-2013 Sudley Place Software

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
***************************************************************************/


//***************************************************************************
//  Prime factoring and number theoretic functions
//***************************************************************************

typedef struct tagNTHPRIMESTR
{
    APLINT aplNthCnt,           // Nth prime count
           aplNthVal;           // Nth prime value
} NTHPRIMESTR;


typedef struct tagMEMTMP
{
    HGLOBAL  hGlbMem;               // 00:  Global memory handle
    LPAPLMPI lpMemOrg,              // 04:  Ptr to original base
             lpMemNxt;              // 08:  Ptr to current
    UINT     uNumEntry,             // 0C:  # valid entries
             uMaxEntry;             // 10:  # entries allocated
                                    // 14:  Length
} MEMTMP, *LPMEMTMP;


typedef struct tagPROCESSPRIME
{
    APLUINT uFcnIndex;              // 00:  Function index (see enum NUMTHEORY) ( 8 bytes)
    APLMPI  mpzDivisor,             // 08:  Result of divisor count/sum         (12 bytes)
            mpzTotient;             // 14:  Result of totient function          (12 bytes)
    UBOOL   bSquareFree;            // 20:  TRUE iff the number is square-free  ( 4 bytes)
    UINT    seed1,                  // 24:  Random seeds
            seed2;                  // 28:  ...
    LPUBOOL lpbCtrlBreak;           // 2C:  Ptr to Ctrl-Break flag
} PROCESSPRIME, *LPPROCESSPRIME;


#define PRECOMPUTED_PRIME_NEXT          100003                  // Next prime after PRECOMPUTED_PRIME_MAX
                                                                //   = min # not factorable by trial division
#define PRECOMPUTED_PRIME_NEXT2         10000600009L            // Square of PRECOMPUTED_PRIME_NEXT
#define PRECOMPUTED_PRIME_NEXT2_MP      {2, {0x54150BC9, 2}}    // PRECOMPUTED_PRIME_NEXT2 as mp_t
#define PRECOMPUTED_PRIME_NEXT2_LOG2    33                      // Floor Log2 of PRECOMPUTED_PRIME_NEXT2

// The Nth prime (in origin-0) in increments of 1E5
APLINT NthPrimeTab[]
#ifdef DEFINE_VALUES
//    xxx00000   xxx100000   xxx200000   xxx300000   xxx400000   xxx500000   xxx600000   xxx700000   xxx800000   xxx900000      // xxxd00000
 = {         2,    1299709,    2750159,    4256233,    5800079,    7368787,    8960453,   10570841,   12195257,   13834103,     //   0dxxxxx
      15485863,   17144489,   18815231,   20495843,   22182343,   23879519,   25582153,   27290279,   29005541,   30723761,     //   1dxxxxx
      32452843,   34186049,   35926307,   37667659,   39410867,   41161739,   42920191,   44680319,   46441207,   48210713,     //   2dxxxxx
      49979687,   51754979,   53533511,   55316903,   57099299,   58885999,   60678089,   62473031,   64268779,   66068881,     //   3dxxxxx
      67867967,   69672821,   71480051,   73289701,   75103493,   76918253,   78736451,   80556703,   82376219,   84200279,     //   4dxxxxx
      86028121,   87857527,   89687683,   91519063,   93354673,   95189089,   97026233,   98866927,  100711433,  102551567,     //   5dxxxxx
     104395301,  106244933,  108092981,  109938667,  111794857,  113648393,  115507867,  117363991,  119227007,  121086457,     //   6dxxxxx
     122949823,  124811173,  126673973,  128541799,  130408841,  132276691,  134150999,  136023761,  137896249,  139772287,     //   7dxxxxx
     141650939,  143522927,  145403459,  147281009,  149163283,  151048969,  152935933,  154819699,  156704111,  158594203,     //   8dxxxxx
     160481183,  162373313,  164263003,  166158637,  168048733,  169941221,  171834293,  173729849,  175628471,  177525767,     //   9dxxxxx
     179424673,  181327577,  183236563,  185133821,  187038013,  188943803,  190850567,  192761039,  194667071,  196576753,     //  10dxxxxx
     198491317,  200401979,  202313623,  204227449,  206141381,  208055039,  209968637,  211887451,  213808381,  215723329,     //  11dxxxxx
     217645177,  219566129,  221489557,  223407631,  225330877,  227254201,  229179857,  231104359,  233031221,  234961003,     //  12dxxxxx
     236887691,  238810163,  240737933,  242673341,  244605341,  246534469,  248467607,  250399337,  252334729,  254269517,     //  13dxxxxx
     256203161,  258141997,  260079329,  262016009,  263956241,  265892017,  267836651,  269778611,  271723961,  273666919,     //  14dxxxxx
     275604541,  277547581,  279495479,  281436539,  283384351,  285335551,  287282221,  289230091,  291177979,  293126077,     //  15dxxxxx
     295075147,  297027257,  298981073,  300928409,  302883137,  304836283,  306789647,  308739217,  310695751,  312650539,     //  16dxxxxx
     314606869,  316564747,  318525661,  320486183,  322445899,  324407071,  326363201,  328323199,  330287501,  332252351,     //  17dxxxxx
     334214459,  336175507,  338141533,  340104239,  342066083,  344032387,  345996247,  347966371,  349931921,  351901153,     //  18dxxxxx
     353868013,  355836331,  357807467,  359777773,  361749959,  363720391,  365691317,  367660357,  369638207,  371614307,     //  19dxxxxx
     373587883,  375556421,  377528077,  379499327,  381471547,  383446673,  385426541,  387404131,  389381593,  391364131,     //  20dxxxxx
     393342739,  395318813,  397303537,  399284911,  401265713,  403245709,  405225637,  407205779,  409192981,  411174217,     //  21dxxxxx
     413158511,  415142291,  417125273,  419113703,  421101607,  423087251,  425069563,  427057783,  429042751,  431031847,     //  22dxxxxx
     433024223,  435011243,  437003033,  438990637,  440981143,  442967111,  444960059,  446952479,  448943699,  450937079,     //  23dxxxxx
     452930459,  454923583,  456911473,  458910583,  460908043,  462900941,  464895083,  466890337,  468884873,  470882761,     //  24dxxxxx
     472882027,  474883943,  476880769,  478876087,  480871421,  482873123,  484870081,  486870887,  488874781,  490872883,     //  25dxxxxx
     492876847,  494877793,  496876883,  498879463,  500883569,  502895639,  504900031,  506904191,  508910483,  510921779,     //  26dxxxxx
     512927357,  514936649,  516939883,  518944403,  520951819,  522960521,  524967329,  526975459,  528981767,  530991353,     //  27dxxxxx
     533000389,  535010669,  537018367,  539028977,  541037239,  543052459,  545066729,  547078999,  549088459,  551096137,     //  28dxxxxx
     553105243,  555119441,  557136673,  559149541,  561166147,  563178731,  565194673,  567211109,  569225609,  571245403,     //  29dxxxxx
     573259391,  575276869,  577292767,  579311267,  581330597,  583344991,  585367061,  587384999,  589405711,  591419083,     //  30dxxxxx
     593441843,  595459177,  597473713,  599500301,  601518829,  603538499,  605558627,  607582951,  609606527,  611630143,     //  31dxxxxx
     613651349,  615673489,  617707253,  619728779,  621753619,  623781251,  625804931,  627826333,  629853421,  631878493,     //  32dxxxxx
     633910099,  635935913,  637961251,  639991237,  642016873,  644047697,  646075669,  648104867,  650132137,  652161761,     //  33dxxxxx
     654188383,  656222537,  658251589,  660280169,  662308567,  664338797,  666372929,  668405761,  670437847,  672474793,     //  34dxxxxx
     674506081,  676541513,  678576023,  680610461,  682647781,  684681287,  686712379,  688744891,  690775711,  692812091,     //  35dxxxxx
     694847533,  696881929,  698922157,  700959703,  702993923,  705031183,  707069521,  709104917,  711145553,  713180443,     //  36dxxxxx
     715225739,  717266387,  719304529,  721343159,  723379829,  725420401,  727459549,  729505199,  731547541,  733588357,     //  37dxxxxx
     735632791,  737675777,  739716323,  741751529,  743798101,  745842997,  747889543,  749934697,  751980767,  754028189,     //  38dxxxxx
     756065159,  758113397,  760158929,  762201659,  764252261,  766301699,  768347857,  770388743,  772432823,  774481031,     //  39dxxxxx
     776531401,  778577603,  780625613,  782671103,  784716613,  786760631,  788811649,  790852627,  792904103,  794957333,     //  40dxxxxx
     797003413,  799048259,  801102793,  803155697,  805200197,  807247079,  809299693,  811349573,  813404693,  815457007,     //  41dxxxxx
     817504243,  819558703,  821611837,  823663219,  825719357,  827772479,  829827407,  831882089,  833934323,  835988177,     //  42dxxxxx
     838041641,  840094007,  842149309,  844202231,  846260201,  848321917,  850372559,  852430793,  854486023,  856542223,     //  43dxxxxx
     858599503,  860662631,  862721399,  864775787,  866836519,  868891391,  870947851,  873008783,  875065817,  877132609,     //  44dxxxxx
     879190747,  881253449,  883311167,  885375347,  887435273,  889495181,  891560603,  893617867,  895682071,  897746119,     //  45dxxxxx
     899809343,  901866937,  903932797,  905995861,  908054761,  910112659,  912171049,  914234731,  916292921,  918363323,     //  46dxxxxx
     920419813,  922484819,  924551933,  926615587,  928683671,  930754031,  932819467,  934881847,  936948209,  939014683,     //  47dxxxxx
     941083981,  943152361,  945217487,  947282641,  949349491,  951421129,  953485501,  955550347,  957617989,  959683147,     //  48dxxxxx
     961748927,  963816181,  965886667,  967956811,  970024733,  972092461,  974165873,  976240099,  978308861,  980380391,     //  49dxxxxx
     982451653,  984516781,  986587201,  988659953,  990729253,  992801857,  994872899,  996943187,  999009019, 1001088107,     //  50dxxxxx
    1003162753, 1005234949, 1007304017, 1009380629, 1011451877, 1013526169, 1015595197, 1017668173, 1019744153, 1021817287,     //  51dxxxxx
    1023893771, 1025965751, 1028045983, 1030118731, 1032193361, 1034270989, 1036348739, 1038420913, 1040493241, 1042567739,     //  52dxxxxx
    1044645379, 1046724713, 1048806701, 1050884503, 1052959783, 1055040169, 1057120817, 1059198443, 1061278423, 1063360561,     //  53dxxxxx
    1065433423, 1067506213, 1069583791, 1071659497, 1073741213, 1075824227, 1077906077, 1079986267, 1082062907, 1084139213,     //  54dxxxxx    where 1,073,741,824 = 1G
    1086218491, 1088297039, 1090378943, 1092458677, 1094539639, 1096621103, 1098701623, 1100784539, 1102864297, 1104944251,     //  55dxxxxx
    1107029837, 1109107253, 1111192081, 1113276293, 1115359771, 1117444343, 1119528997, 1121609641, 1123692467, 1125782591,     //  56dxxxxx
    1127870669, 1129953137, 1132040563, 1134127453, 1136217679, 1138305527, 1140386773, 1142478331, 1144570519, 1146654763,     //  57dxxxxx
    1148739811, 1150826449, 1152910463, 1154994961, 1157079821, 1159168499, 1161258347, 1163341759, 1165422541, 1167514379,     //  58dxxxxx
    1169604791, 1171689551, 1173775301, 1175864957, 1177951681, 1180041901, 1182135187, 1184227511, 1186319989, 1188407897,     //  59dxxxxx
    1190494759, 1192588087, 1194679553, 1196767769, 1198855067, 1200949601, 1203042517, 1205137007, 1207224929, 1209316387,     //  60dxxxxx
    1211405357, 1213498529, 1215591277, 1217679989, 1219769731, 1221863249, 1223955217, 1226052941, 1228150967, 1230242557,     //  61dxxxxx
    1232332807, 1234429783, 1236521497, 1238613793, 1240713113, 1242809749, 1244904751, 1246994587, 1249088263, 1251177259,     //  62dxxxxx
    1253270831, 1255366601, 1257465709, 1259559751, 1261655503, 1263751051, 1265848763, 1267938631, 1270027249, 1272127847,     //  63dxxxxx
    1274224957, 1276323817, 1278421999, 1280512421, 1282612589, 1284710761, 1286807363, 1288907089, 1291002239, 1293100093,     //  64dxxxxx
    1295202449, 1297303597, 1299403691, 1301502313, 1303601461, 1305698197, 1307795869, 1309889047, 1311987541, 1314089269,     //  65dxxxxx
    1316196199, 1318295597, 1320395743, 1322492417, 1324597727, 1326697549, 1328798533, 1330902689, 1332998411, 1335097117,     //  66dxxxxx
    1337195521, 1339296229, 1341399347, 1343497193, 1345602019, 1347701827, 1349804851, 1351911629, 1354008883, 1356105077,     //  67dxxxxx
    1358208601, 1360311233, 1362413363, 1364516113, 1366619791, 1368724829, 1370828699, 1372933249, 1375040473, 1377146363,     //  68dxxxxx
    1379256017, 1381359613, 1383461369, 1385569993, 1387679107, 1389786317, 1391880629, 1393991569, 1396093981, 1398200021,     //  69dxxxxx
    1400305337, 1402416707, 1404522391, 1406632613, 1408737013, 1410844901, 1412953517, 1415056481, 1417168867, 1419270833,     //  70dxxxxx
    1421376527, 1423485493, 1425593951, 1427705233, 1429808717, 1431916081, 1434028823, 1436135291, 1438247861, 1440355823,     //  71dxxxxx
    1442469307, 1444576369, 1446680869, 1448788633, 1450899343, 1453010719, 1455122587, 1457229523, 1459338641, 1461446099,     //  72dxxxxx
    1463554999, 1465666361, 1467780943, 1469897861, 1472008799, 1474118911, 1476223303, 1478328587, 1480443031, 1482557971,     //  73dxxxxx
    1484670157, 1486778297, 1488884051, 1490994863, 1493105791, 1495213259, 1497325279, 1499438797, 1501552331, 1503670901,     //  74dxxxxx
    1505776939, 1507890353, 1510006037, 1512124807, 1514242181, 1516351729, 1518466931, 1520577043, 1522690627, 1524805991,     //  75dxxxxx
    1526922013, 1529034763, 1531145207, 1533263591, 1535377607, 1537493869, 1539612983, 1541729069, 1543847677, 1545959687,     //  76dxxxxx
    1548074321, 1550188489, 1552302677, 1554418787, 1556536483, 1558655453, 1560772009, 1562894057, 1565016157, 1567130869,     //  77dxxxxx
    1569250357, 1571368109, 1573488157, 1575604039, 1577719111, 1579833473, 1581950131, 1584065599, 1586187721, 1588305269,     //  78dxxxxx
    1590425971, 1592539519, 1594668367, 1596782263, 1598903287, 1601020423, 1603141801, 1605258409, 1607375929, 1609500209,     //  79dxxxxx
    1611623773, 1613743561, 1615863217, 1617986011, 1620110813, 1622223983, 1624347293, 1626468817, 1628590741, 1630707479,     //  80dxxxxx
    1632828047, 1634944559, 1637064469, 1639187113, 1641305917, 1643429659, 1645557581, 1647680431, 1649802389, 1651927219,     //  81dxxxxx
    1654054489, 1656180739, 1658302649, 1660426583, 1662547951, 1664674813, 1666793153, 1668920809, 1671043001, 1673164277,     //  82dxxxxx
    1675293211, 1677416063, 1679535223, 1681661797, 1683786757, 1685912257, 1688031613, 1690153847, 1692281089, 1694404627,     //  83dxxxxx
    1696528903, 1698655957, 1700784637, 1702911317, 1705036297, 1707155651, 1709282381, 1711403627, 1713531991, 1715661209,     //  84dxxxxx
    1717783147, 1719908483, 1722031669, 1724159621, 1726290701, 1728417349, 1730548769, 1732677211, 1734807101, 1736937523,     //  85dxxxxx
    1739062363, 1741187411, 1743317041, 1745442869, 1747573759, 1749701911, 1751828921, 1753957531, 1756083457, 1758214567,     //  86dxxxxx
    1760341421, 1762473943, 1764602683, 1766727143, 1768858577, 1770989609, 1773118121, 1775253671, 1777379803, 1779508277,     //  87dxxxxx
    1781636611, 1783765981, 1785896653, 1788027707, 1790159311, 1792287221, 1794417743, 1796542417, 1798670239, 1800800357,     //  88dxxxxx
    1802933611, 1805066969, 1807198867, 1809327281, 1811461151, 1813593017, 1815727987, 1817859761, 1819993883, 1822127963,     //  89dxxxxx
    1824261409, 1826397169, 1828525451, 1830661409, 1832796743, 1834925101, 1837056671, 1839190961, 1841324831, 1843456001,     //  90dxxxxx
    1845587707, 1847726627, 1849864279, 1851998107, 1854134603, 1856264453, 1858397407, 1860536947, 1862670911, 1864804687,     //  91dxxxxx
    1866941107, 1869080047, 1871212289, 1873350979, 1875484249, 1877619433, 1879754089, 1881892841, 1884030413, 1886170613,     //  92dxxxxx
    1888303061, 1890435181, 1892570837, 1894712051, 1896848351, 1898979367, 1901109673, 1903250693, 1905386117, 1907527507,     //  93dxxxxx
    1909662901, 1911801631, 1913940349, 1916074159, 1918218371, 1920354659, 1922496841, 1924632253, 1926775133, 1928909971,     //  94dxxxxx
    1931045213, 1933183247, 1935319663, 1937458507, 1939601633, 1941743593, 1943880439, 1946020457, 1948154261, 1950293383,     //  95dxxxxx
    1952429173, 1954566797, 1956706313, 1958847701, 1960989991, 1963130467, 1965269353, 1967413223, 1969551707, 1971688711,     //  96dxxxxx
    1973828641, 1975967179, 1978106699, 1980245453, 1982386073, 1984525421, 1986669821, 1988809567, 1990951111, 1993090283,     //  97dxxxxx
    1995230813, 1997376149, 1999520641, 2001658163, 2003793923, 2005933261, 2008075057, 2010220559, 2012361283, 2014495793,     //  98dxxxxx
    2016634091, 2018781689, 2020923643, 2023066349, 2025211361, 2027354341, 2029501861, 2031647489, 2033788391, 2035929101,     //  99dxxxxx
    2038074743, 2040217561, 2042368609, 2044505809, 2046648347, 2048795513, 2050930517, 2053078381, 2055223739, 2057369519,     // 100dxxxxx
    2059519669, 2061668159, 2063812627, 2065956251, 2068101317, 2070248573, 2072396189, 2074537987, 2076681863, 2078825449,     // 101dxxxxx
    2080975129, 2083115761, 2085262093, 2087412763, 2089555987, 2091702643, 2093846737, 2095989419, 2098139227, 2100286763,     // 102dxxxxx
    2102429869, 2104575677, 2106722207, 2108866007, 2111010917, 2113154941, 2115298223, 2117447621, 2119595131, 2121744967,     // 103dxxxxx
    2123895971, 2126044699, 2128193597, 2130347599, 2132500393, 2134651579, 2136801203, 2138954381, 2141097779, 2143243691,     // 104dxxxxx
    2145390523, 2147535953, 2149686127, 2151833507, 2153982037, 2156130601, 2158281527, 2160428327, 2162578603, 2164729087,     // 105dxxxxx    where 2,147,483,648 = 2G
    2166877459, 2169029309, 2171173559, 2173328099, 2175476561, 2177624377, 2179772717, 2181925943, 2184081461, 2186234213,     // 106dxxxxx
    2188381931, 2190533659, 2192681963, 2194832323, 2196982037, 2199134027, 2201288489, 2203445077, 2205600197, 2207748583,     // 107dxxxxx
    2209898659, 2212055009, 2214204029, 2216358631, 2218510109, 2220657809, 2222812729, 2224969277, 2227120013, 2229271651,     // 108dxxxxx
    2231422087, 2233580831, 2235730723, 2237880233, 2240033461, 2242187723, 2244340829, 2246490019, 2248642757, 2250792521,     // 109dxxxxx
    2252945251, 2255101141, 2257257913, 2259413381, 2261561297, 2263710359, 2265866011, 2268014663, 2270168993, 2272317263,     // 110dxxxxx
    2274464657, 2276616449, 2278774651, 2280933913, 2283090919, 2285247989, 2287397153, 2289549389, 2291707577, 2293861487,     // 111dxxxxx
    2296014671, 2298172087, 2300323643, 2302483789, 2304639433, 2306797469, 2308955381, 2311109497, 2313263633, 2315416199,     // 112dxxxxx
    2317573351, 2319740543, 2321892611, 2324048471, 2326203199, 2328364919, 2330527967, 2332684609, 2334837419, 2336994857,     // 113dxxxxx
    2339150657, 2341308929, 2343465799, 2345629529, 2347785239, 2349946219, 2352105463, 2354260157, 2356419277, 2358574711,     // 114dxxxxx
    2360739643, 2362897547, 2365058291, 2367215233, 2369369903, 2371528559, 2373688243, 2375848823, 2378005573, 2380165889,     // 115dxxxxx
    2382327887, 2384482301, 2386642171, 2388804259, 2390960093, 2393118281, 2395280423, 2397444691, 2399604377, 2401765291,     // 116dxxxxx
    2403927803, 2406089911, 2408249143, 2410409497, 2412570271, 2414731181, 2416896901, 2419051123, 2421215411, 2423375057,     // 117dxxxxx
    2425530169, 2427686897, 2429851469, 2432015273, 2434175983, 2436343309, 2438499647, 2440656529, 2442818101, 2444982401,     // 118dxxxxx
    2447142727, 2449309847, 2451476663, 2453633869, 2455793533, 2457955471, 2460121057, 2462284427, 2464452751, 2466611437,     // 119dxxxxx
    2468776129, 2470936049, 2473094593, 2475257159, 2477417023, 2479578839, 2481738947, 2483901619, 2486067299, 2488233619,     // 120dxxxxx
    2490401359, 2492567837, 2494728931, 2496897527, 2499062453, 2501226703, 2503396513, 2505557059, 2507716103, 2509880047,     // 121dxxxxx
    2512046833, 2514205909, 2516368537, 2518531033, 2520697099, 2522861207, 2525029393, 2527193729, 2529355141, 2531522047,     // 122dxxxxx
    2533680361, 2535848867, 2538009011, 2540175229, 2542335739, 2544507941, 2546674129, 2548840397, 2550999643, 2553167531,     // 123dxxxxx
    2555333789, 2557496437, 2559660491, 2561827679, 2563996163, 2566154603, 2568322357, 2570486771, 2572651579, 2574815437,     // 124dxxxxx
    2576983867, 2579150653, 2581317593, 2583483101, 2585650867, 2587819877, 2589986303, 2592148271, 2594320951, 2596486429,     // 125dxxxxx
    2598653287, 2600820119, 2602993529, 2605158851, 2607331093, 2609503691, 2611669391, 2613838127, 2616009637, 2618176531,     // 126dxxxxx
    2620343177, 2622509899, 2624680109, 2626850911, 2629018349, 2631187679, 2633357491, 2635531823, 2637704129, 2639873749,     // 127dxxxxx
    2642042561, 2644214341, 2646386129, 2648555509, 2650724431, 2652900959, 2655067091, 2657230249, 2659402219, 2661577489,     // 128dxxxxx
    2663748103, 2665918793, 2668089737, 2670257267, 2672430221, 2674597283, 2676766181, 2678935081, 2681104297, 2683282643,     // 129dxxxxx
    2685457421, 2687622481, 2689790843, 2691962813, 2694137389, 2696305511, 2698474729, 2700647101, 2702816681, 2704990657,     // 130dxxxxx
    2707161461, 2709332473, 2711504261, 2713675927, 2715848053, 2718019537, 2720191181, 2722366103, 2724545323, 2726714597,     // 131dxxxxx
    2728895893, 2731072667, 2733243421, 2735417159, 2737592027, 2739760321, 2741928913, 2744111791, 2746285361, 2748463871,     // 132dxxxxx
    2750638547, 2752808449, 2754985859, 2757153703, 2759329753, 2761509749, 2763680053, 2765859589, 2768031521, 2770205237,     // 133dxxxxx
    2772373133, 2774547053, 2776720291, 2778894673, 2781070661, 2783243681, 2785422011, 2787594437, 2789769041, 2791944583,     // 134dxxxxx
    2794119103, 2796295207, 2798468503, 2800648579, 2802818719, 2804992679, 2807167861, 2809344511, 2811522353, 2813700793,     // 135dxxxxx
    2815869317, 2818047019, 2820220093, 2822394329, 2824565083, 2826744601, 2828921659, 2831095733, 2833276907, 2835454187,     // 136dxxxxx
    2837630963, 2839807627, 2841987179, 2844165281, 2846341187, 2848518523, 2850696449, 2852869087, 2855043769, 2857218839,     // 137dxxxxx
    2859399863, 2861572331, 2863748059, 2865925079, 2868102493, 2870280233, 2872456333, 2874634561, 2876815741, 2878993097,     // 138dxxxxx
    2881172057, 2883350179, 2885528587, 2887707113, 2889887639, 2892069233, 2894247157, 2896423207, 2898605027, 2900781973,     // 139dxxxxx
    2902958801, 2905136453, 2907315629, 2909496259, 2911680391, 2913858991, 2916038891, 2918217521, 2920398017, 2922576817,     // 140dxxxxx
    2924759963, 2926933771, 2929110607, 2931290711, 2933470453, 2935653607, 2937834203, 2940012377, 2942189207, 2944369297,     // 141dxxxxx
    2946551921, 2948730553, 2950909553, 2953089077, 2955277343, 2957462413, 2959641151, 2961824497, 2964002077, 2966180527,     // 142dxxxxx
    2968362013, 2970548237, 2972731667, 2974913993, 2977094311, 2979272113, 2981452549, 2983636231, 2985818027, 2987993753,     // 143dxxxxx
    2990179831, 2992357127, 2994540371, 2996726641, 2998916069, 3001098227, 3003285563, 3005464853, 3007652029, 3009838681,     // 144dxxxxx
    3012017609, 3014196697, 3016380293, 3018564391, 3020747063, 3022932373, 3025117087, 3027303869, 3029486489, 3031670617,     // 145dxxxxx
    3033850613, 3036035239, 3038216609, 3040400017, 3042582001, 3044762209, 3046946519, 3049131731, 3051317081, 3053500123,     // 146dxxxxx
    3055685081, 3057865903, 3060049943, 3062237957, 3064417283, 3066595487, 3068781059, 3070964387, 3073143001, 3075326173,     // 147dxxxxx
    3077513171, 3079698199, 3081882491, 3084069853, 3086253223, 3088441337, 3090625409, 3092812739, 3095002453, 3097185803,     // 148dxxxxx
    3099373523, 3101565161, 3103753859, 3105943669, 3108125639, 3110310719, 3112497467, 3114684773, 3116871097, 3119053723,     // 149dxxxxx
    3121238909, 3123424987, 3125607061, 3127792937, 3129976469, 3132168491, 3134354599, 3136544153, 3138730229, 3140916607,     // 150dxxxxx
    3143102429, 3145292543, 3147479981, 3149663863, 3151848533, 3154034621, 3156218743, 3158407559, 3160595027, 3162785831,     // 151dxxxxx
    3164969219, 3167154103, 3169342973, 3171528643, 3173720597, 3175911671, 3178100297, 3180282533, 3182476273, 3184665637,     // 152dxxxxx
    3186853091, 3189035089, 3191224681, 3193415801, 3195602363, 3197792467, 3199982531, 3202170821, 3204353939, 3206541937,     // 153dxxxxx
    3208726513, 3210918037, 3213106837, 3215297999, 3217486633, 3219680053, 3221870849, 3224058767, 3226250431, 3228442963,     // 154dxxxxx    where 3,221,225,472 = 3G
    3230631829, 3232825177, 3235010837, 3237201349, 3239395193, 3241584487, 3243775349, 3245963197, 3248151889, 3250344469,     // 155dxxxxx
    3252531827, 3254715889, 3256906663, 3259098721, 3261286571, 3263483551, 3265674779, 3267868783, 3270065137, 3272255341,     // 156dxxxxx
    3274449029, 3276637649, 3278828321, 3281019607, 3283211227, 3285400837, 3287591179, 3289782407, 3291976343, 3294166303,     // 157dxxxxx
    3296363293, 3298549981, 3300748511, 3302940029, 3305127277, 3307315943, 3309511693, 3311708819, 3313899541, 3316090511,     // 158dxxxxx
    3318283333, 3320467741, 3322657321, 3324850237, 3327040421, 3329233711, 3331427717, 3333617321, 3335809483, 3338000467,     // 159dxxxxx
    3340200037, 3342394441, 3344588887, 3346780693, 3348976151, 3351166229, 3353360513, 3355555393, 3357756277, 3359953957,     // 160dxxxxx
    3362143849, 3364335323, 3366531793, 3368723437, 3370919917, 3373110317, 3375306953, 3377497237, 3379693111, 3381893587,     // 161dxxxxx
    3384088471, 3386281499, 3388472383, 3390661199, 3392864401, 3395057291, 3397249727, 3399446233, 3401642093, 3403833373,     // 162dxxxxx
    3406031009, 3408226187, 3410423377, 3412617581, 3414812267, 3417006779, 3419202949, 3421394503, 3423582191, 3425778283,     // 163dxxxxx
    3427973503, 3430165213, 3432367409, 3434568227, 3436762391, 3438957499, 3441153377, 3443345333, 3445543373, 3447733147,     // 164dxxxxx
    3449931889, 3452125379, 3454319039, 3456516779, 3458717453, 3460911073, 3463104433, 3465297499, 3467493719, 3469691503,     // 165dxxxxx
    3471893387, 3474089551, 3476285387, 3478487569, 3480676307, 3482876303, 3485070937, 3487265189, 3489463559, 3491665091,     // 166dxxxxx
    3493866473, 3496055897, 3498253667, 3500453491, 3502652183, 3504849011, 3507041221, 3509237057, 3511434607, 3513630257,     // 167dxxxxx
    3515827213, 3518025257, 3520224569, 3522423353, 3524621273, 3526816673, 3529013711, 3531218921, 3533412419, 3535610633,     // 168dxxxxx
    3537803429, 3540008321, 3542203913, 3544408943, 3546605801, 3548802013, 3550997753, 3553199729, 3555394301, 3557594197,     // 169dxxxxx
    3559788179, 3561998093, 3564197743, 3566394127, 3568593373, 3570787739, 3572990513, 3575194459, 3577395463, 3579595291,     // 170dxxxxx
    3581791331, 3583990451, 3586191263, 3588392107, 3590594237, 3592802893, 3595004419, 3597197489, 3599401609, 3601603727,     // 171dxxxxx
    3603805021, 3605999483, 3608204503, 3610407821, 3612608267, 3614818223, 3617013941, 3619210163, 3621408907, 3623607397,     // 172dxxxxx
    3625809167, 3628012343, 3630209867, 3632409317, 3634608779, 3636814213, 3639014563, 3641209757, 3643407407, 3645606761,     // 173dxxxxx
    3647809349, 3650010391, 3652211531, 3654408223, 3656614789, 3658818851, 3661025999, 3663229391, 3665435017, 3667626439,     // 174dxxxxx
    3669829403, 3672029827, 3674234303, 3676433707, 3678629329, 3680834551, 3683037343, 3685245467, 3687450803, 3689654093,     // 175dxxxxx
    3691857803, 3694059821, 3696259331, 3698469107, 3700670651, 3702875521, 3705079457, 3707284183, 3709488257, 3711694751,     // 176dxxxxx
    3713895587, 3716096987, 3718300499, 3720499301, 3722693479, 3724898209, 3727105033, 3729307427, 3731506087, 3733709989,     // 177dxxxxx
    3735911761, 3738115201, 3740320279, 3742523467, 3744725701, 3746933507, 3749137201, 3751345019, 3753546221, 3755756387,     // 178dxxxxx
    3757961567, 3760163167, 3762366961, 3764572883, 3766780477, 3768978061, 3771187103, 3773392871, 3775598773, 3777801617,     // 179dxxxxx
    3780008329, 3782210071, 3784419707, 3786626209, 3788834249, 3791040401, 3793249613, 3795451727, 3797654881, 3799864561,     // 180dxxxxx
    3802067851, 3804269089, 3806476603, 3808680307, 3810890009, 3813097241, 3815301851, 3817503257, 3819708181, 3821916379,     // 181dxxxxx
    3824122121, 3826330801, 3828541837, 3830744903, 3832953191, 3835154891, 3837365557, 3839570291, 3841775177, 3843986831,     // 182dxxxxx
    3846198203, 3848411317, 3850617077, 3852826337, 3855035531, 3857245739, 3859447567, 3861656863, 3863859431, 3866073319,     // 183dxxxxx
    3868277299, 3870480463, 3872690893, 3874899647, 3877106119, 3879316271, 3881519363, 3883725569, 3885932629, 3888141721,     // 184dxxxxx
    3890351567, 3892563229, 3894769951, 3896982059, 3899190877, 3901399927, 3903608183, 3905807177, 3908014079, 3910226351,     // 185dxxxxx
    3912435773, 3914650709, 3916865137, 3919076101, 3921283543, 3923496961, 3925704337, 3927917627, 3930125599, 3932333687,     // 186dxxxxx
    3934544879, 3936754693, 3938959471, 3941169307, 3943377923, 3945592087, 3947795303, 3949999877, 3952210697, 3954419297,     // 187dxxxxx
    3956628523, 3958840423, 3961052317, 3963254941, 3965464123, 3967676077, 3969889331, 3972103249, 3974311573, 3976520909,     // 188dxxxxx
    3978735073, 3980944783, 3983156327, 3985369877, 3987579223, 3989791469, 3992007109, 3994218089, 3996428749, 3998635051,     // 189dxxxxx
    4000846301, 4003052701, 4005264743, 4007479153, 4009688953, 4011903809, 4014120179, 4016331601, 4018548467, 4020755533,     // 190dxxxxx
    4022963641, 4025176601, 4027391569, 4029602069, 4031815441, 4034025029, 4036238257, 4038452933, 4040665969, 4042872791,     // 191dxxxxx
    4045093753, 4047306443, 4049516899, 4051729333, 4053938267, 4056148807, 4058361859, 4060572407, 4062784657, 4064995483,     // 192dxxxxx
    4067203991, 4069420669, 4071641641, 4073859301, 4076068357, 4078283057, 4080501409, 4082712181, 4084924463, 4087134269,     // 193dxxxxx
    4089353447, 4091563031, 4093774189, 4095986179, 4098204427, 4100420453, 4102637327, 4104848513, 4107060547, 4109272523,     // 194dxxxxx
    4111485199, 4113700433, 4115908081, 4118123311, 4120332371, 4122542063, 4124755949, 4126969303, 4129183691, 4131392431,     // 195dxxxxx
    4133602927, 4135817909, 4138035683, 4140255283, 4142471023, 4144683677, 4146898331, 4149115913, 4151325953, 4153542271,     // 196dxxxxx
    4155754901, 4157975093, 4160187991, 4162405393, 4164626941, 4166844271, 4169058247, 4171272827, 4173493879, 4175710069,     // 197dxxxxx
    4177926497, 4180142437, 4182358951, 4184576069, 4186789417, 4189007551, 4191218819, 4193442467, 4195655353, 4197871049,     // 198dxxxxx
    4200086549, 4202297107, 4204505861, 4206722257, 4208938117, 4211155607, 4213371167, 4215583909, 4217800333, 4220018489,     // 199dxxxxx
    4222234741, 4224447653, 4226670757, 4228885889, 4231100803, 4233321569, 4235534981, 4237751977, 4239974339, 4242190867,     // 200dxxxxx
    4244406151, 4246622197, 4248837847, 4251053773, 4253271221, 4255494377, 4257712243, 4259930327, 4262147633, 4264364641,     // 201dxxxxx
    4266581161, 4268801093, 4271019563, 4273234571, 4275449239, 4277659159, 4279875367, 4282091071, 4284310843, 4286521963,     // 202dxxxxx
    4288745689, 4290967253, 4293184081,                                                                                         // 203dxxxxx    where 4,294,967,296 = 4G
    -1
   }
#endif
;

EXTERN
int NthPrimeInc
#ifdef DEFINE_VALUES
 = 100000
#endif
;

EXTERN
UINT NthPrimeCnt
#ifdef DEFINE_VALUES
 = countof (NthPrimeTab) - 1
#endif
;

typedef struct tagNTHPOWERTAB
{
    LPCHAR lpChar;
    APLMPI aplMPI;
} NTHPOWERTAB, *LPNTHPOWERTAB;

// The Nth prime (in origin-0) in powers of 10
// The following values were obtained from
//   http://oeis.org/A006988/
EXTERN
NTHPOWERTAB NthPowerTab[]
#ifdef DEFINE_VALUES
= {{"3",                     0},    // 1E0
   {"31",                    0},    // 1E1
   {"547",                   0},    // 1E2
   {"7927",                  0},    // 1E3
   {"104743",                0},    // 1E4
   {"1299721",               0},    // 1E5
   {"15485867",              0},    // 1E6
   {"179424691",             0},    // 1E7
   {"2038074751",            0},    // 1E8
   {"22801763513",           0},    // 1E9
   {"252097800629",          0},    // 1E10
   {"2760727302559",         0},    // 1E11
   {"29996224275851",        0},    // 1E12
   {"323780508946379",       0},    // 1E13
   {"3475385758524587",      0},    // 1E14
   {"37124508045065489",     0},    // 1E15
   {"394906913903735377",    0},    // 1E16
   {"4185296581467695677",   0},    // 1E17
   {"44211790234832169353",  0},    // 1E18
   {"-1"                  ,  0},
  }
#endif
;

EXTERN
UINT NthPowerCnt
#ifdef DEFINE_VALUES
 = countof (NthPowerTab)
#endif
;

// The # primes <= powers of ten
// The following values were obtained from
//   http://oeis.org/A006880
EXTERN
APLINT NumPowerTab[]
#ifdef DEFINE_VALUES
 = {0,                      // 1E0
    4,                      // 1E1
    25,                     // 1E2
    168,                    // 1E3
    1229,                   // 1E4
    9592,                   // 1E5
    78498,                  // 1E6
    664579,                 // 1E7
    5761455,                // 1E8
    50847534,               // 1E9
    455052511,              // 1E10
    4118054813,             // 1E11
    37607912018,            // 1E12
    346065536839,           // 1E13
    3204941750802,          // 1E14
    29844570422669,         // 1E15
    279238341033925,        // 1E16
    2623557157654233,       // 1E17
    24739954287740860,      // 1E18
    234057667276344607,     // 1E19
    2220819602560918840,    // 1E20
   }
#endif
;


//***************************************************************************
//  End of File: primes.h
//***************************************************************************
