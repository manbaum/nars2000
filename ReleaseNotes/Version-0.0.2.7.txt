Version 0.0.2.7 consists of the following Builds:


Build #618 -- Version 0.0.2.7
-----------------------------

* Display The Default Prompt More Centrally

Directory trunk:

IMMEXEC.C:
  Append new struc entry for use in <WaitForimmExecStmt>.
  In <WaitForImmExecStmt>, if there's no next level to be
    signalled, display the default prompt.
  In <ImmExecStmt>, pass on to <WaitForImmExecStmt> the Edit
    Ctrl window handle so it can be used to display the default
    prompt.
  In <ImmExecStmtInThread>, remove code which displays the
    default prompt as well as related code as that's now done
    more centrally.
  In <ActOnError>, if the result of executing []ELX is DISPLAY
    or NODISPLAY and there's a result in <YYResExec>, display it.

PF_UTACKJOT.C:
  In <PrimFnMonUpTackJotCommon_EM_YY>, handle the case of
    EXITTYPE_RETURNxLX.
  In <PrimFnMonUpTackJotCSPLParse>, don't display the default
    prompt as that's now done more centrally.
  In <PrimFnMonUpTackJotPLParse>, clean up the code.
  Remove unnecessary cast.

PL_PARSE.Y:
  If the return from "LeftOper ArrExpr" is from executing []ELX,
    abort execution as the result has been displayed.
  In <ParseLine>, move duplicate declarations to the top so
    they may be used commonly.
  In <ParseLine> after executing the line, handle the
    EXITTYPE_RETURNxLX case.
  In <ParseLine>, don't restore the previous value of <PlLocalVars>
    until after executing []ALX or []ELX so it may be used by
    that code.
  In <ParseLine> after executing []ALX/[]ELX if the result is
    DISPLAY or NODISPLAY and there's a result in <YYResExec>,
    display it.
  In <ParseLine>, don't display the default prompt as that's now
    done more centrally.
  Improve comments.


Build #617 -- Version 0.0.2.7
-----------------------------

* Fix Bug:  Prompt Displays Before Error Message in Execute Primitive

Directory trunk:

ERRMSG.C:
  Display function name and line # in error message along with
    as many execute symbols as there are nested executes.

IMMEXEC.C:
  Call <PrimFnMonUpTackJotCSPLParse> instead of <ImmExecStmt> when
    executing []ALX or []ELX so as not to introduce a spurious
    immediate execution mode SIS level.

MAIN.C:
  Use unique debugging numbers on calls to <DisplayPrompt> so we can
    tell them apart when debugging.

MAIN.H:
  Update copyright year.
  Define new EXITTYPE_xxx so as to distinguish between executing []ALX
    or []ELX vs. other executes.

PF_UTACKJOT.C:
  If we just returned from executing []ALX/[]ELX, don't display the
    prompt as we haven't displayed the result as yet.

PL_PARSE.Y:
  Call <PrimFnMonUpTackJotCSPLParse> instead of <ImmExecStmt> when
    executing []ALX or []ELX so as not to introduce a spurious
    immediate execution mode SIS level.
  Pass on as the exit type whether or not we just returned from
    executing []ALX or []ELX so the caller can avoid an untimely
    display of the prompt.

SC_IN.C:
SC_LOAD.C:
  Call <PrimFnMonUpTackJotCSPLParse> instead of <ImmExecStmt> when
    executing data or function assignments so as not to introduce
    a spurious immediate execution mode SIS level.


Build #616 -- Version 0.0.2.7
-----------------------------

* Handle UTF16_TILDE2 The Same As UTF16_TILDE.

Directory trunk:

INITDATA.C:
PF_TILDE.C:
SYMBOLNAMES.H:
  Handle UTF16_TILDE2 the same as UTF16_TILDE.

TOKENIZE.C:
  In <fnPointAcc>, use equates instead of symbols for numeric
    constant parsing.  This change should have been included
    in Build #614.
  Handle UTF16_TILDE2 the same as UTF16_TILDE.
  Map UTF16_STILETILDE as a monadic operator (not as yet implemented).

TRANSLATE.C:
  In <TranslateNARSToAPL2>, map UTF16_TILDE and UTF16_STILE to
    corresponding one-byte chars.

UNICODE.H:
  Handle UTF16_TILDE2 the same as UTF16_TILDE.
  Improve comments.


Build #615 -- Version 0.0.2.7
-----------------------------

* Merge INDEX_xxx and UTF16_xxx For Primitive Functions

Directory trunk:

EXECFNS.C:
  Replace INDEX_xxx with UTF16_xxx for primitive functions as we no
    longer need the former.  We still need them for operators as
    functions and operators share the same table <PrimProtoFnsTab>.

EXTERNS.H:
  Update copyright year.
  Widen the primitive function and operator tables by one bit so we
    don't need to use the INDEX_xxx equates for primitive functions.

INITDATA.C:
PL_PARSE.Y:
PO_DIJOT.C:
SYMTRANS.C:
TRANSLATE.C:
UNICODE.H:
  Update copyright year.
  Replace INDEX_xxx with UTF16_xxx for primitive functions as we no
    longer need the former.  We still need them for operators as
    functions and operators share the same table <PrimProtoFnsTab>.


Build #614 -- Version 0.0.2.7
-----------------------------

* Use Equates Instead Of Symbols For Numeric Constant Parsing

Directory trunk:

DEFINES.H:
  Define equate for infinity symbol and overbar as single-byte chars
    for use in <pn_parse.y>.

PN_PARSE.Y:
  Update copyright year.
  Define token name for overbar symbol instead of using symbol.
  Use equates for overbar and infinity symbols instead of symbols.


Build #613 -- Version 0.0.2.7
-----------------------------

* Define User Preference For Display Of Function Line #s

Directory trunk:

CUSTOMIZE.C:
  Update copyright year.
  Reformat long lines.
  Define User Preference for default display of function line #s.

DEFINES.H:
  Define default initial value for display of function line #s.
  Define current function line # display state in window extra bytes.

EDITFCN.C:
  When setting the Edit Ctrl left margin, take into account the
    current function line # display state.
  Initialize the current function line # display state.
  When drawing the function line #s, take into account the current
    function line # display state.

EXTERNS.H:
  Define entry in <OPTIONFLAGS> for default display of function line #s.

INIFILE.C:
  Update copyright year.
  Define keyname for the default display of function line #s.
  Handle read in/write out default display of function line #s option.
  Improve comments.

MAIN.RC:
  Update copyright year.
  Use proper escape symbols for Windows header files.
  Define User Preference for default display of function line #s.

RESOURCE.H:
  Update copyright year.
  Improve comments.
  Omit unused Icon IDs.
  Define User Preference for default display of function line #s.


Build #612 -- Version 0.0.2.7
-----------------------------

* Catch LIMIT ERROR on )SAVE

Directory trunk:

DEFINES.H:
  Update copyright year.
  Increase size of temp storage.

DISPLAY.C:
EDITFCN.C:
EXECMFN.C:
EXTERNS.H:
SESSMAN.C:
  Remove #ifdef DEBUG from around virtual memory allocation so it
    appears in the crash window for non-DEBUG cases.

EXCEPT.C:
  Display text of source for each virtual memory allocation in the
    crash window for non-=DEBUG cases.

EXTERNS.H:
  Update copyright year.
  Remove #ifdef DEBUG from around virtual memory allocation so it
    appears in the crash window for non-DEBUG cases.
  Include Alt-f (Underbar) in list of duplicated symbols.
  Define Alt-space as space so we don't need to release that key
    in mid-typing.

MAIN.C:
  Update copyright year.
  Improve comments.
  Remove #ifdef DEBUG from around virtual memory allocation so it
    appears in the crash window for non-DEBUG cases.

SC_SAVE.C:
  Catch LIMIT ERROR on )SAVE.


Build #611 -- Version 0.0.2.7
-----------------------------

* Fix Bug:  Handle UDFO Via Operator or Train With No Value.

Directory trunk:

DATATYPE.H:
  Include ptr to UDFO in VFO Header ptrs union as we need to skip
    a Ref Cnt Incr for that object.

EXECDFN.C:
EXECFNS.C:
PO_DIERESIS.C:
PO_DOT.C:
PO_SLASH.C:
PO_SLOPE.C:
  Fix Bug:  When executing a UDFO via an operator or Train, test to
    see if the UDFO does not return a result and signal a VALUE ERROR.

FH_PARSE.H:
  Define new flag in <DFN_HEADER>.

GETFNS.C:
  In <GetGlbPtrs_LOCK>, handle the <TKT_FCNNAMED> case.
  Improve comments.

PRIMFNS.C:
  Define new routine <IsTknTypeVar> for use in <Set/ClrVFOArraySRCIFlag>.
  In <Set/ClrVFOArraySRCIFlag>, handle UDFOs.

REFCNT.C:
  In <ChangeRefCntDir_PTB>, handle <SkipRefCntIncr> for UDFOs.


Build #610 -- Version 0.0.2.7
-----------------------------

* Fix Bug:  Reference Count For Trains Incorrect

Directory trunk:

DATATYPE.H:
  Update copyright year.
  Define new flag in <FCNARRAY_HEADER>.
  Define variable/function/operator header ptrs union.

DISPDBG.C:
  Improve comments.
  In <DisplayGlobals>, surround the function array with parens unless
    it's a Train.
  Fix Bug:  The display of a Train one of whose elements is a derived
    function (hence, multiple element), displays the first element only.
  In <DisplayFcnSub> for Function Arrays, use <DisplayFcnMem> to display
    rather than <DisplayFcnSub> so as to handle Trains.

GETFNS.C:
  In <GetGlbPtrs_LOCK>, handle <TKT_FCNIMMED> case.

MAKEPRO.PHP:
  Improve comments.
  Fix prototype stmts.

PL_PARSE.Y:
  Ensure all <YYFree>s are followed by setting the ptr to NULL.
  When calling <MakeFcnStrand>/<PushFcnStrand> when working with
    Trains set the <SkipRefCntIncr> flag so as not to introduce a
    memory leak when the Train goes through its final call to
    <MakeFcnStrand> as the <LeftOper> is instantiated.

PRIMFNS.C:
  In <CopyArray_EM> for Function Arrays, increment the top level
    reference count as that's where Trains come in.
  Define <IsTknTypeFcnOpr> to determine if a token type is a fcn/opr.
  Rename <SetVarArraySRCIFlag> to <SetVFOArraySRCIFlag> to encompass
    fcn/opr as well as var and rename vars within the new function to
    reflect the dual meaning.
  Rename <ClrVarArraySRCIFlag> to <ClrVFOArraySRCIFlag> for the same
    reasons as above.

REFCNT.C:
  Update copyright year.
  In <ChangeRefCntDir_PTB>, check for and handle the <SkipRefCntIncr>
    flag for function arrays, too.

STRAND.C:
  Rename <ClrVarArraySRCIFlag> to <ClrVFOArraySRCIFlag>.
  Improve comments.


Build #609 -- Version 0.0.2.7
-----------------------------

* Define Another Resource Debugging Function

Directory trunk:

ERRMSG.C:
YYFNS.C:
  Use <MyGlobalHandle> instead of <GlobalHandle>.

RESDEBUG.C:
  Update copyright year.
  Define <_MyGlobalHandle> function to catch more resource errors.

RESDEBUG.H:
  Update copyright year.
  Define <MyGlobalHandle> for DEBUG and non-DEBUG cases.


Build #608 -- Version 0.0.2.7
-----------------------------

* Obtain PTD Ptr Via Subroutine So We Can Handle Odd Cases

Directory trunk:

ASSIGN.C:
DEBUG.C:
DISPDBG.C:
DISPLAY.C:
EDITFCN.C
ERRMSG.C:
EXCEPT.C:
EXECDFN.C:
EXECFNS.C:
EXECMFN.C:
GETFNS.C:
GOTO.C:
IMMEXEC.C:
PF_DSHOE.C:
PF_DTACKJOT.C:
PF_IOTA.C:
PF_TILDE.C:
PF_UARROW.C:
PF_UTACKJOT.C:
PL_PARSE.Y:
PO_DIJOT.C:
PO_SLASH.C:
PRIMFNS.C:
QF_CR.C:
QF_DL.C:
QF_DM.C:
QF_EM.C:
QF_ERROR.C:
QF_ES.C:
QF_ET.C:
QF_EX.C:
QF_FMT.C:
QF_FX.C:
QF_LC.C:
QF_MF.C:
QF_NL.C:
QF_TF.C:
QF_VR.C:
SAVEFCN.C:
SC_COMMON.C:
SC_COPY.C:
SC_FNOV.C:
SC_IN.C:
SC_LIB.C:
SC_LOAD.C:
SC_OUT.C:
SC_RESET.C:
SC_SAVE.C:
SC_SI.C:
SC_WSID.C:
SESSMAN.C:
STRAND.C:
SYMTAB.C:
SYSVARS.C:
TABCTRL.C:
TOKENIZE.C:
YYFNS.C:
  Update copyright year.
  Obtain PTD Ptr via subroutine so we can handle odd cases.


Build #607 -- Version 0.0.2.7
-----------------------------

* Define Tools Directory

Directory \:

TOOLS:
  Define Tools directory to hold global tools.


Build #606 -- Version 0.0.2.7
-----------------------------

* Fix Bug When Parsing 1 []TF 'a b'

Directory trunk:

QF_TF.C:
  In <SysFnDydTF1_EM_YY> when parsing 1 []TF 'a b', a SWITCH stmt
    falls through to a defstop instead of branching to the empty
    case because the blank after the 'a' is interpreted as marking
    the inverse translation case and the following char is not one
    of 'FCN'.


Build #605 -- Version 0.0.2.7
-----------------------------

* Fix Bug When Translating UpCaret (0x2227) For []TF or )OUT

Directory trunk:

TRANSLATE.C:
  In <TranslateNARSToAPL2>, when translating an UpCaret to APL2
    if the char is not found, make it a circumflex (^).


Build #604 -- Version 0.0.2.7
-----------------------------

* Fix Bug When Returning A Multiple Name Result From A UDFO

Directory trunk:

PRIMFNS.C:
  In <MakeMonPrototype_EM_PTB>, use direct reference to item instead
    of through function.
  In <MakeMonPrototype_EM_PTB>, use macro around a LPSYMENTRY before
    saving in result.
  Fix Bug:  In <CopySymGlbDir_PTB>, when given a named STE, convert
    it to a value-specific unnamed STE.  That way, the named STE
    may be changed without affecting the return value.
  Change <CopyImmSymEntry_EM> to use a named equate instead of -1.
  In <CopyArray_EM>, use macro around a LPSYMENTRY before saving in
    result.

STRAND.C:
  Change <CopyImmSymEntry_EM> to use a named equate instead of -1.
  In <MakeVarStrand_EM_YY>, use macro around a LPSYMENTRY before
    saving in result.

SYMTAB.C:
  In <MakeSymEntry_EM>, allow NULL ptr to function token.
  In <CopyImmSymEntry_EM>, use named equate instead of -1.
  In <CopyImmSymEntry_EM>, allow NULL ptr to function token.

SYMTAB.H:
  Define named equate to use instead of -1.
